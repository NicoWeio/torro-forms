/*!
 * Torro Forms Version 1.0.3 (https://torro-forms.com)
 * Licensed under GNU General Public License v2 (or later) (http://www.gnu.org/licenses/gpl-2.0.html)
 */
!function(t,n,e,o){"use strict";function i(n,e,o){return e&&e.length?l[n]&&l[n][e]?void o(l[n][e]):void t.api.init().done(function(){new t.api.models.ApiActionConnection({action:n,connection:e}).fetch({data:{context:"view"},context:this,success:function(t){l[n]||(l[n]={}),l[n][e]=t.attributes,o(t.attributes)},error:function(){console.error(u.couldNotLoadData)}})}).fail(function(){console.error(u.couldNotLoadData)}):void o(void 0)}function r(t,n,e){var o;if(!t||!n||!n.length)return void e(void 0);for(o=0;o<t.routes.length;o++)if(t.routes[o].slug===n)return void e(t.routes[o]);e(void 0)}function c(t){var o=e(".plugin-lib-repeatable-group-"+t+"__integrations-wrap");o.length&&e(document).ready(function(){var o=n.FieldManager.instances[s].get(s+"_"+t.replace("_","-")+"--integrations");o.on("changeItemValue:connection",function(n,r,c){var a=r.name.match(/\[(\d+)\]$/),l=o.get("items");a&&l&&(a=parseInt(a[1],10),l[a]&&i(t,c.connection,function(t){var n={},o=[],i=e("#"+l[a].fields.route.id),r=i.val();n[""]=u.selectARoute,o.push({id:"",text:u.selectARoute}),t&&t.routes.forEach(function(t){n[t.slug]=t.title,o.push({id:t.slug,text:t.title})}),l[a].fields.route.choices=n,i.empty().select2({data:o}),r&&!n[r]&&i.val("").trigger("change")}))}),o.on("changeItemValue:route",function(n,e,o){i(t,o.connection,function(t){r(t,o.route,function(t){console.log(t)})})})})}var a=o.actions,u=o.i18n,l={},s=e("#torro_module_actions-field-manager-instance");n.FieldView.FieldmappingsFieldView=n.FieldView.extend({getEvents:function(){return{}},applyParams:function(){this.renderContent()}}),a.length&&s.length&&(s=s.val(),a.forEach(c))}(window.torro,window.pluginLibFieldsAPI,window.jQuery,window.torroAPIActionsData||{});