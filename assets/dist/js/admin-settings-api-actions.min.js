/*!
 * Torro Forms Version 1.0.3 (https://torro-forms.com)
 * Licensed under GNU General Public License v2 (or later) (http://www.gnu.org/licenses/gpl-2.0.html)
 */
!function(t,e,r,i){"use strict";function n(t){return t.replace(/\s+/g,"-").replace(/[^A-Za-z0-9_-]+/g,"").toLowerCase()}var a,s=i.action,l=i.i18n,u=r("#torro_module_actions-field-manager-instance"),c=r(".plugin-lib-repeatable-group-"+s+"__connections-wrap");u.length&&c.length&&r(document).ready(function(){u=u.val(),a=e.FieldManager.instances[u].get(u+"_"+s.replace("_","-")+"--connections"),a.on("changeItemValue:title",function(t,e,i){var a,s;i.slug&&i.slug.length||i.title&&i.title.length&&(a=r("#"+e.id+"-slug"),a.length&&(s=n(i.title),s.length&&a.val(s).trigger("change")))}),t.api.init().done(function(){new t.api.models.ApiAction({action:s}).fetch({data:{context:"view"},context:this,success:function(t){function e(t,e){var n=Object.keys(e.fields),a=r("#"+e.fields.title.labelAttrs.id).children("span");n.forEach(function(n){var s=e.fields[n],l=!1;s.inputAttrs["data-authenticator"]&&(i[t]&&(l=!!s.inputAttrs["data-authenticator"].match(new RegExp("(^|,)"+i[t]+"(,|$)"))),l!==s.display&&(s.display=l,s.required=s.display,s.inputAttrs.tabindex=s.display?"0":"-1",s.inputAttrs.required=!!s.required,s.wrapAttrs.class=s.display?s.wrapAttrs.class.replace(" plugin-lib-hidden",""):s.wrapAttrs.class+" plugin-lib-hidden",s.wrapAttrs["aria-hidden"]=s.display?"false":"true",r("#"+s.inputAttrs.id).attr("tabindex",s.inputAttrs.tabindex),r("#"+s.inputAttrs.id).prop("required",s.inputAttrs.required),r("#"+s.wrapAttrs.id).attr("class",s.wrapAttrs.class),r("#"+s.wrapAttrs.id).attr("aria-hidden",s.wrapAttrs["aria-hidden"]),s.required?r("#"+s.labelAttrs.id).append(a.clone()):r("#"+s.labelAttrs.id).children("span").remove()))})}var i={};t.get("structures").forEach(function(t){i[t.slug]=t.authentication_type}),a.get("items").forEach(function(t){e(t.fields.structure.currentValue,t)}),a.on("addItem",function(t,r){e(r.fields.structure.currentValue,r)}),a.on("changeItemValue:structure",function(t,r,i){i.structure&&i.structure.length&&e(i.structure,r)})},error:function(){console.error(l.couldNotLoadData)}})}).fail(function(){console.error(l.couldNotLoadData)})})}(window.torro,window.pluginLibFieldsAPI,window.jQuery,window.torroAPIActionsData);